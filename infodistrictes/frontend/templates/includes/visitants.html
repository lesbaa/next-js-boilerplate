<div id="visitants_graph"></div>

<script>
    data = {{ ecomuseumvisits_data |safe }};
    make_viz_visitants(data);

    var es_ES = {
        "decimal": ",",
        "thousands": ".",
        "grouping": [3],
        "currency": ["€", ""],
        "dateTime": "%a %b %e %X %Y",
        "date": "%d/%m/%Y",
        "time": "%H:%M:%S",
        "periods": ["AM", "PM"],
        "days": ["Domingo", "Lunes", "Martes", "Miércoles", "Jueves", "Viernes", "Sábado"],
        "shortDays": ["Dom", "Lun", "Mar", "Mi", "Jue", "Vie", "Sab"],
        "months": ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"],
        "shortMonths": ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"]
    };

    var es_delt = d3.locale(es_ES);

    var numberFormat = es_delt.numberFormat(",.0f");

    function make_viz_visitants(data){
        var visualization = d3plus.viz()
            .container("#visitants_graph")
            .data(data)
            .type("line")       // visualization type
            .id("Any")         // key for which our data is unique on
            // .text("Any")       // key to use for display text
            .y({"value": "Visitants", "grid": false})         // key to use for y-axis
            .x({"value": "Mes", "grid": false, "label":""})          // key to use for x-axis
            .color("Color")
            .font({ "family": "Raleway",
                "size": 14
            })
            .title({
                value: "Visitants mensuals a l'Ecomuseu",
                "font": {"size": 18}
            })
            .background("#f5f5f5")
            .axes({"background": {"color": "#f5f5f5"}})
            .format({
                "text": function(text,key){
                    return text
                },
                "number": function(number, params) {
                    return numberFormat(number);
                }
            })
            .legend({
                "labels": true,
                "size": 35,
                "order": "id",
                "font": {"size": 12}
            })
            // .labels(true)
            .tooltip({
                "share": true,
                "value": ["Mes", "Visitants"]
            })
            .order(function(d) {
                return ["Desembre", "Novembre", "Octubre", "Setembre", "Agost", "Juliol", "Juny", "Maig", "Abril", "Març", "Febrer", "Gener"].indexOf(d.Mes)}
            )
            .draw();
    }

</script>